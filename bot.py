import random
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.utils.keyboard import ReplyKeyboardBuilder

API_TOKEN = "8291150179:AAEE6ioQM6-kDi-qvIMR6fPcv6eFnNDgVIE"

bot = Bot(token=API_TOKEN)
dp = Dispatcher()

# ---------------------------
# –ë–ê–ó–ê –§–†–ê–ó
# ---------------------------
PHRASES = [
    "–†–∞—Å—Å–∫–∞–∂–∏ –ø–∞—Ä—Ç–Ω—ë—Ä—É —Å–≤–æ–π —Å–∞–º—ã–π –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–æ–∏–∑–Ω–µ—Å–∏ –∏–º—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞ —Å–∞–º—ã–º —Å–æ–±–ª–∞–∑–Ω—è—é—â–∏–º –≥–æ–ª–æ—Å–æ–º. –ò–ª–∏ –ø–µ–π.",
    "–°–¥–µ–ª–∞–π –ø–∞—Ä—Ç–Ω—ë—Ä—É –ª—ë–≥–∫–∏–π –º–∞—Å—Å–∞–∂ –ø–ª–µ—á –≤ —Ç–µ—á–µ–Ω–∏–µ 20 —Å–µ–∫—É–Ω–¥. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–∫–∞–∂–∏ —Å–≤–æ—é —Å–∞–º—É—é ¬´–æ–±–∞—è—Ç–µ–ª—å–Ω—É—é¬ª –ø–æ–∑—É –º–æ–¥–µ–ª—å–Ω–æ–π —Å—ä—ë–º–∫–∏. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–æ–∏–∑–Ω–µ—Å–∏ —Ç–æ—Å—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —Å–ª—É—á–∞–π–Ω–æ ¬´–ø–µ—Ä–µ–ø—É—Ç–∞–µ—à—å¬ª –ø–∞—Ä—Ç–Ω—ë—Ä–∞ —Å –∫–∏–Ω–æ–∑–≤–µ–∑–¥–æ–π. –ò–ª–∏ –ø–µ–π.",
    "–ò–∑–æ–±—Ä–∞–∑–∏, –∫–∞–∫ —Ç—ã —Ä–∞–¥—É–µ—à—å—Å—è, —É–≤–∏–¥–µ–≤ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ–π —Ä–∞–∑–ª—É–∫–∏. –ò–ª–∏ –ø–µ–π.",
    "–°–∫–∞–∂–∏ 3 –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±–µ –≤ –ø–∞—Ä—Ç–Ω—ë—Ä–µ –Ω—Ä–∞–≤—è—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–ø—Ä–æ—Å–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –∑–∞–≥–∞–¥–∞—Ç—å –∂–µ–ª–∞–Ω–∏–µ ‚Äî –≤—ã–ø–æ–ª–Ω–∏ –µ–≥–æ. –ò–ª–∏ –ø–µ–π.",
    "–°—ã–≥—Ä–∞–π –ø–∞—Ä—Ç–Ω—ë—Ä—É –º–∏–Ω–∏-—Å—Ü–µ–Ω–∫—É —Ä–µ–≤–Ω–æ—Å—Ç–∏ –≤ —à—É—Ç–æ—á–Ω–æ–π —Ñ–æ—Ä–º–µ. –ò–ª–∏ –ø–µ–π.",
    "–í—Å–ø–æ–º–Ω–∏ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω—ë—Ä —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ –≤–ø–µ—á–∞—Ç–ª–∏–ª, –∏ —Ä–∞—Å—Å–∫–∞–∂–∏ –æ –Ω—ë–º. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–∏–¥—É–º–∞–π –Ω–æ–≤–æ–µ –ª–∞—Å–∫–æ–≤–æ–µ –ø—Ä–æ–∑–≤–∏—â–µ –¥–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞. –ò–ª–∏ –ø–µ–π.",
    "–ò–∑–æ–±—Ä–∞–∑–∏ —Ç–∞–Ω–µ—Ü —Ä–∞–¥–æ—Å—Ç–∏. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ—Ö–≤–∞—Å—Ç–∞–π—Å—è —á–µ–º-—Ç–æ, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å –æ—Ç–ª–∏—á–Ω–æ. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–æ–∏–∑–Ω–µ—Å–∏ —Ñ—Ä–∞–∑—É: ¬´–¢—ã ‚Äî –º–æ–π –≥–ª–∞–≤–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä¬ª. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–∫–∞–∂–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ ¬´—è —Ö–æ—á—É –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π¬ª. –ò–ª–∏ –ø–µ–π.",
    "–†–∞—Å—Å–∫–∞–∂–∏ –ø–∞—Ä—Ç–Ω—ë—Ä—É –º–∏–Ω–∏-–∏—Å—Ç–æ—Ä–∏—é, –≥–¥–µ –æ–Ω –≥–µ—Ä–æ–π. –ò–ª–∏ –ø–µ–π.",
    "–û—Ç–≤–µ—Ç—å —á–µ—Å—Ç–Ω–æ –Ω–∞ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –ø–∞—Ä—Ç–Ω—ë—Ä–∞. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–∑–≤–æ–ª—å –ø–∞—Ä—Ç–Ω—ë—Ä—É –≤—ã–±—Ä–∞—Ç—å —Ç–µ–±–µ –∑–∞–¥–∞–Ω–∏–µ. –ò–ª–∏ –ø–µ–π.",
    "–°–¥–µ–ª–∞–π –ø–∞—Ä—Ç–Ω—ë—Ä—É –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π, –Ω–æ –º–∏–ª—ã–π –∂–µ—Å—Ç –≤–Ω–∏–º–∞–Ω–∏—è. –ò–ª–∏ –ø–µ–π.",
    "–ò–∑–æ–±—Ä–∞–∑–∏ –º—É–ª—å—Ç—è—à–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ—Ç—Å—è —Ñ–ª–∏—Ä—Ç–æ–≤–∞—Ç—å. –ò–ª–∏ –ø–µ–π.",
    "–°–∫–∞–∂–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ —Å–ª–æ–≤–∞–º–∏ ¬´–≤–µ—á–µ—Ä¬ª, ¬´–∏—Å–∫—Ä—ã¬ª, ¬´–º—ã¬ª. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–∫–∞–∂–∏ —Å–≤–æ—é –ª—É—á—à—É—é ¬´—Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é¬ª —É–ª—ã–±–∫—É. –ò–ª–∏ –ø–µ–π.",
    "–°–∫–∞–∂–∏ –ø–∞—Ä—Ç–Ω—ë—Ä—É, –∑–∞ —á—Ç–æ —Ç—ã –µ–≥–æ —Ü–µ–Ω–∏—à—å. –ò–ª–∏ –ø–µ–π.",
    "–°–ø–æ–π –∫—É–ø–ª–µ—Ç –ø–µ—Å–Ω–∏, –ø–µ—Ä–µ–¥–µ–ª–∞–≤ —Å–ª–æ–≤–∞ –ø—Ä–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–∏–¥—É–º–∞–π –Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–± –ø–æ–∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è. –ò–ª–∏ –ø–µ–π.",
    "–û–ø–∏—à–∏ –∏–¥–µ–∞–ª—å–Ω—ã–π —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –≤–µ—á–µ—Ä. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–∏–¥—É–º–∞–π —Å–ª–æ–≥–∞–Ω –≤–∞—à–µ–≥–æ –¥—É—ç—Ç–∞. –ò–ª–∏ –ø–µ–π.",
    "–°–∫–∞–∂–∏ —Ñ—Ä–∞–∑—É, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –ø–∞—Ä—Ç–Ω—ë—Ä—É —Å—Ç–∞–Ω–µ—Ç —Ç–µ–ø–ª–µ–µ. –ò–ª–∏ –ø–µ–π.",
    "–í–µ–¥–∏ —Å–µ–±—è 20 —Å–µ–∫—É–Ω–¥ —Ç–∞–∫, –±—É–¥—Ç–æ –ø–∞—Ä—Ç–Ω—ë—Ä ‚Äî —Å—É–ø–µ—Ä–∑–≤–µ–∑–¥–∞. –ò–ª–∏ –ø–µ–π.",
    "–ü–æ–∫–∞–∂–∏ –ø—Ä–µ—É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π ¬´–≤–ª—é–±–ª—ë–Ω–Ω—ã–π –≤–∑–≥–ª—è–¥¬ª. –ò–ª–∏ –ø–µ–π.",
    "–ü—Ä–æ–∏–∑–Ω–µ—Å–∏: ¬´–°–µ–≥–æ–¥–Ω—è —Ç—ã –≤—ã–≥–ª—è–¥–∏—à—å –æ–ø–∞—Å–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ¬ª. –ò–ª–∏ –ø–µ–π.",
    "–°–ª–æ–∂–∏ –º–∏–Ω–∏-–ø–æ—ç–º—É –∏–∑ 2 —Å—Ç—Ä–æ–∫. –ò–ª–∏ –ø–µ–π.",
    "–°–∫–∞–∂–∏, –∫–∞–∫–æ–π –º–æ–º–µ–Ω—Ç –≤–µ—á–µ—Ä–∞ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ. –ò–ª–∏ –ø–µ–π.",
    "–ü—É—Å—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä –∑–∞–≥–∞–¥–∞–µ—Ç —ç–º–æ—Ü–∏—é ‚Äî –ø–æ–∫–∞–∂–∏ –µ—ë. –ò–ª–∏ –ø–µ–π.",
    "–ò–∑–æ–±—Ä–∞–∑–∏ 3 —Ç–∏–ø–∞ —Ñ–ª–∏—Ä—Ç–∞. –ò–ª–∏ –ø–µ–π.",
    "–ü–µ–π, –µ—Å–ª–∏ –∫–æ–≥–¥–∞-—Ç–æ –∫—Ä–∞—Å–Ω–µ–ª –∏–∑-–∑–∞ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—Ç–µ–ª –±—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã—Ö –≤–µ—á–µ—Ä–æ–≤.",
    "–ü–µ–π, –µ—Å–ª–∏ –æ–¥–Ω–∞–∂–¥—ã —Ä–µ–≤–Ω–æ–≤–∞–ª –ø–∞—Ä—Ç–Ω—ë—Ä–∞.",
    "–ü–µ–π, –µ—Å–ª–∏ –≤–∞—Å —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–º–µ—à–Ω–æ–π —Å–µ–∫—Ä–µ—Ç.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ç–∞–π–∫–æ–º –ª—é–±—É–µ—à—å—Å—è –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º.",
    "–ü–µ–π, –µ—Å–ª–∏ —Å–∫–∞–∑–∞–ª –±—ã –ø–∞—Ä—Ç–Ω–µ—Ä—É —á—Ç–æ-—Ç–æ –º–∏–ª–æ–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.",
    "–ü–µ–π, –µ—Å–ª–∏ –∫–æ–≥–¥–∞-—Ç–æ —Å—Ç–µ—Å–Ω—è–ª—Å—è, –∞ –ø–∞—Ä—Ç–Ω—ë—Ä –ø–æ–¥–¥–µ—Ä–∂–∞–ª.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —É–º–µ–µ—Ç —É–¥–∏–≤–ª—è—Ç—å.",
    "–ü–µ–π, –µ—Å–ª–∏ –ª—é–±–∏—à—å, –∫–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω—ë—Ä –¥–µ–ª–∞–µ—Ç —á—Ç–æ-—Ç–æ –ø–æ-—Å–≤–æ–µ–º—É.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —Å–µ–≥–æ–¥–Ω—è —É–ª—ã–±–∞–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ —Ç–µ–±—è —Ü–µ–ø–ª—è–µ—Ç.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø—ã—Ç–∞–ª—Å—è —Å–∫—Ä—ã—Ç—å, —á—Ç–æ –ø–∞—Ä—Ç–Ω—ë—Ä –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è.",
    "–ü–µ–π, –µ—Å–ª–∏ –≤–∞—Å –∫–æ–≥–¥–∞-—Ç–æ —Ä–∞–∑–±–∏—Ä–∞–ª —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π —Å–º–µ—Ö.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä –∑–Ω–∞–µ—Ç –æ —Ç–µ–±–µ —Ç–æ, —á—Ç–æ –Ω–µ –∑–Ω–∞—é—Ç –¥—Ä—É–≥–∏–µ.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ-—Ç–æ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–µ, –Ω–æ –ø–æ—Å—Ç–µ—Å–Ω—è–ª—Å—è.",
    "–ü–µ–π, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–∏-—à—É—Ç–∫–∏.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —Å–ø–∞—Å–∞–ª –æ—Ç –Ω–µ–ª–æ–≤–∫–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞.",
    "–ü–µ–π, –µ—Å–ª–∏ –≤—ã–±–∏—Ä–∞–ª –æ–¥–µ–∂–¥—É –ø–æ–ª—É—á—à–µ —Ä–∞–¥–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –µ—â—ë –±–æ–ª—å—à–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —Ä–∞–∑–æ—Ä—É–∂–∞–µ—Ç –≤–∑–≥–ª—è–¥–æ–º.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—Ç–µ–ª –±—ã –ø—Ä–æ–¥–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–µ—á–µ—Ä.",
    "–ü–µ–π, –µ—Å–ª–∏ ¬´—É–ª–µ—Ç–∞–ª –º–æ–∑–≥¬ª –æ—Ç –º–æ–º–µ–Ω—Ç–∞ —Å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º.",
    "–ü–µ–π, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ª—é–±–∏–º–∞—è –ø–µ—Å–Ω—è –∏–ª–∏ —Ñ–∏–ª—å–º.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä –¥–µ–ª–∞–ª –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –ø—Ä–∏—è—Ç–Ω—ã–π —Å—é—Ä–ø—Ä–∏–∑.",
    "–ü–µ–π, –µ—Å–ª–∏ –≤—ã –∏–Ω–æ–≥–¥–∞ –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç–µ—Å—å —Å–µ—Ä—å—ë–∑–Ω—ã–º–∏.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—Ç–µ–ª –±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ç—ë–ø–ª—ã–π –¥–µ–Ω—å.",
    "–ü–µ–π, –µ—Å–ª–∏ –¥—É–º–∞–ª: ¬´–ö–∞–∫ –∂–µ –∫—Ä—É—Ç–æ, —á—Ç–æ —É –Ω–∞—Å —ç—Ç–æ –µ—Å—Ç—å¬ª.",
    "–ü–µ–π, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä –¥–µ–π—Å—Ç–≤—É–µ—Ç ¬´–æ–ø–∞—Å–Ω–æ —Ö–æ—Ä–æ—à–æ¬ª.",
    "–ü–µ–π, –µ—Å–ª–∏ —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞—Ä—Ç–Ω—ë—Ä—É.",
    "–ü–µ–π, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–ª –±—ã –ø–∞—Ä—Ç–Ω—ë—Ä–∞ —Å–Ω–æ–≤–∞.",
    "–ü–µ–π, –µ—Å–ª–∏ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ –ø–∞—Ä—Ç–Ω—ë—Ä –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç —Ç–≤–æ—ë –∏–º—è.",
    "–ü–µ–π, –µ—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è —Å–≤–æ–±–æ–¥–Ω–µ–µ —Ä—è–¥–æ–º —Å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º.",
    "–ü–µ–π, –µ—Å–ª–∏ —ç—Ç–æ—Ç –≤–µ—á–µ—Ä —É–∂–µ –∑–∞–¥–∞–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ."
]

# –ò–≥—Ä–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
user_data = {}
last_message = {}      # –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ñ—Ä–∞–∑–æ–π
user_inputs = {}       # –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è


# -------------------------------------------------------
# –ö–ù–û–ü–ö–ò
# -------------------------------------------------------
def start_keyboard():
    kb = ReplyKeyboardBuilder()
    kb.button(text="–ù–∞—á–∞—Ç—å")
    kb.adjust(1)
    return kb.as_markup(resize_keyboard=True)


def game_keyboard():
    kb = ReplyKeyboardBuilder()
    kb.button(text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å")
    kb.button(text="–ó–∞–∫–æ–Ω—á–∏—Ç—å")
    kb.adjust(2)
    return kb.as_markup(resize_keyboard=True)


# -------------------------------------------------------
# –°–¢–ê–†–¢ –ò–ì–†–´
# -------------------------------------------------------
@dp.message(Command("start"))
async def start(message: types.Message):
    uid = message.from_user.id

    rules = (
        "‚ú® *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É –¥–ª—è –¥–≤–æ–∏—Ö!* ‚ú®\n\n"
        "–ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:\n"
        "‚ù§Ô∏è –Ø –±—É–¥—É –¥–∞–≤–∞—Ç—å –≤–∞–º –∑–∞–¥–∞–Ω–∏—è –∏–∑ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–π –∏ –∏–≥—Ä–∏–≤–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏.\n"
        "üé≤ –ó–∞–¥–∞–Ω–∏—è –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è ‚Äî –∫–∞–∂–¥—ã–π —Ä–∞–∑ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ.\n"
        "üëâ –ñ–º–∏ *–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å*, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ.\n"
        "üõë –•–æ—á–µ—à—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è ‚Äî –Ω–∞–∂–º–∏ *–ó–∞–∫–æ–Ω—á–∏—Ç—å*.\n"
        "üßπ –ß–∞—Ç –±—É–¥–µ—Ç –æ—á–∏—â–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ.\n\n"
        "–ì–æ—Ç–æ–≤—ã? üòâ"
    )

    user_data[uid] = {"remaining": list(PHRASES)}
    last_message[uid] = None
    user_inputs[uid] = None

    await message.answer(rules, parse_mode="Markdown", reply_markup=start_keyboard())


# -------------------------------------------------------
# –ù–ê–ß–ê–õ–û –ò–ì–†–´
# -------------------------------------------------------
@dp.message(lambda m: m.text == "–ù–∞—á–∞—Ç—å")
async def begin(message: types.Message):
    uid = message.from_user.id
    user_data[uid] = {"remaining": list(PHRASES)}
    await clean_user_message(message)
    await send_phrase(message)


# -------------------------------------------------------
# –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï –ò–ì–†–´
# -------------------------------------------------------
@dp.message(lambda m: m.text == "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å")
async def next_phase(message: types.Message):
    await clean_user_message(message)
    await send_phrase(message)


# -------------------------------------------------------
# –ó–ê–í–ï–†–®–ï–ù–ò–ï –ò–ì–†–´
# -------------------------------------------------------
@dp.message(lambda m: m.text == "–ó–∞–∫–æ–Ω—á–∏—Ç—å")
async def end(message: types.Message):
    uid = message.from_user.id

    await clean_user_message(message)

    # —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Ñ—Ä–∞–∑—É
    if last_message.get(uid):
        try:
            await bot.delete_message(uid, last_message[uid])
        except:
            pass
        last_message[uid] = None

    # —Å–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
    user_data[uid] = {"remaining": list(PHRASES)}

    await message.answer(
        "–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ üß°\n–ù–∞–∂–º–∏ *–ù–∞—á–∞—Ç—å*, —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞!",
        reply_markup=start_keyboard()
    )


# -------------------------------------------------------
# –õ–û–ì–ò–ö–ê –ü–û–ö–ê–ó–ê –§–†–ê–ó
# -------------------------------------------------------
async def send_phrase(message: types.Message):
    uid = message.from_user.id
    remaining = user_data[uid]["remaining"]

    # –µ—Å–ª–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å —Ñ—Ä–∞–∑—ã
    if not remaining:
        await end(message)
        return

    # —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ñ—Ä–∞–∑—É
    if last_message.get(uid):
        try:
            await bot.delete_message(uid, last_message[uid])
        except:
            pass

    # –Ω–æ–≤–∞—è —Ñ—Ä–∞–∑–∞
    phrase = random.choice(remaining)
    remaining.remove(phrase)

    sent = await message.answer(phrase, reply_markup=game_keyboard())
    last_message[uid] = sent.message_id


# -------------------------------------------------------
# –£–î–ê–õ–ï–ù–ò–ï –ü–†–ï–î–´–î–£–©–ò–• –°–û–û–ë–©–ï–ù–ò–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
# -------------------------------------------------------
async def clean_user_message(message: types.Message):
    """–£–¥–∞–ª—è–µ—Ç –ø—Ä–æ—à–ª–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    uid = message.from_user.id

    # —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ—à–ª—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_inputs.get(uid):
        try:
            await bot.delete_message(uid, user_inputs[uid])
        except:
            pass

    # –∑–∞–ø–æ–º–Ω–∏—Ç—å –Ω–æ–≤–æ–µ
    user_inputs[uid] = message.message_id


# -------------------------------------------------------
# –ó–ê–ü–£–°–ö
# -------------------------------------------------------
if __name__ == "__main__":
    import asyncio
    asyncio.run(dp.start_polling(bot))
